======================== POWERSHELL ================================

most wmiobjects are Win32_ (means they only works on windows) which pulls information straight from the kernel about objects as opposed to just running the normal command to receive that information 

should not see pipes when viewing the processes

there are differences between user profiles in Powershell, Powershell ISE, and the newest version of powershell
start powershell -noprofile will load powershell without a profile
look for a powershell command ran with -windowstyle Hidden which means something is being hidden from you
can also change the version of the powershell you are about to run with -version <version number>

get-item WSMAN:\localhost\client\trustedhosts ping trusted hosts that can be Winrm'd into, can also use set item instead of give to set a trusted host make sure to add -concatenate to add as opposed to overwrite

invoke-command -comptername pwnd_host { restart-computer } -asjob 
invoke-command -computername a workstation,server C:\windows\findevil.ps1 
invoke-command is used to run commands remotely on other workstations with a small session while new-pssession which creates a more permanent session with the remote device

========================== WINDOWS REGISTRY ==============================

the registry is a heirarchial database that stores system wide settings as well as profile settings

hive keys always start with HKEY and are the main big groups of data like HKEY_Current_User or HKEY_Local_Machine
Registry keys are basically directories or subdirectories (subkeys) 
Registry values are the actual entries that contain data which can be read

HKEY_CLASSES_ROOT is a symbolic link to the classes subkey in in HKEY_Local_Machine which contains all the file extensions and what file pertains to them
ren can rename file extensions to change their extension to whatever you want ex calc.exe to calc.lol
classes have to have a default key with an actual value which defaults to string upon creation unless specified otherwise
the default key in classes describes what the files with said extension should be treated like ex an exefile which is executable which also needs a specific designation since there are many different executable types in windows

HKEY_Local_Machine is just the local machine settings

HKEY_CurrentUser is a symbolic link to the HKEY_Users key containing the settings for the currently logged in user

HKEY_Users has the normal settings for every user sorted by their sid and a classes key which specifies how you choose to open your extensions

only Admins can open and change any other HKEY then the one for their user account

HKEY_LOCAL_MACHINE KEYS
even administrators cant view the SAM key which holds security tokens and usernames for every user account
BCD00000000 deals with the boot configuration of the system
Hardware has drivers and other such hardware related data
Security contains the lsass configuration data
System has the boot or driver startup applications
Software has the system wide user downloaded applications 

the S-1-5-18 account is local system
the S-1-5-19 account is local service
the S-1-5-20 account is networking account

the 21 in a user account represents the domain while the numbers after represent the machine they are on and what order they were created in

Files are needed to store registry values to load them on every boot
user setting are stored in the NTUSER.DAT file for every user which is the user's registry settings
system settings are stored in the system32/config file which stores the registry settings where RegBack is the registry backup file

for the GUI regedit is used to manipulate the registry and add/delete keys or change data
data we use primarily is string, binary, and DWORD which can provide either a decimal or hexadecimal 32 bit value (QWORD for 64 bit)

subkeys can also be saved to export/import entire subkeys to other systems

to use the cmd to edit registry values use reg along with a command like ADD or DELETE 
reg query does not take astericks (and wildcards in general) which means you would have to take each individual sid using reg query

powershell uses get-item to just get KEYS and what their name is/data associated with them
get-childitem gives the subkeys for a key using -recurse to get all the subkeys as well as registry values and data ex get-childitem HKLM:\
set-itemproperty -path HKLM:\software\microsoft\windows\currentversion\run\etc.(any key/path) -name <name of registry value> -value <data to put in value>
new-itemproperty works the same as set-itemproperty but creates a new value

use get-psdrive gets the currently mounted filesystems then use new-PSdrive -name HKU -PSProvider registry -root HKEY_Users to mount the HKU as a PSDRIVE to view in powershell 
use add-content "<previous command>" $profile.allusersallhosts to add it to the users profiles then run &$profile.allusersallhosts to reload the file without restarting powershell
can alternatively just use registry::HKEY_Users instead of creating a new key to specify that its a registry path not a filesystem in PSDRIVE
on powershell can use wildcards like asterick* to query multiple values like all users ex get-item HKU:\*\<path>

HKLM\SOFTWARE\microsoft\windows\currentversion\profilelist contains a list of all users that have logged in
HKLM\SOFTWARE\microsoft\windows\currentversion\Image File Execution File Options tells a file what to do every single time it is executed
files can be created in Image File Execution to run other commands using the dataname Debugger then given it a executable path as data, though doing this requires real time monitoring to be disabled since this is a well known exploit
after performing this exploit you can go to the lock screen and click the ease of access button to open a command prompt as the system authority

use set-mppreference -DisableRealTimeMonitoring $True to disable windows defenders ability to prevent the previously described exploit

========================================== WINDOWS ADS (Alternate Data Stream) ===================================

windows uses NTFS (new technology file system) as its default which allows a lot more partitions (26 primary) and over a terrabyte of storage 
Windows used to use FAT (file allocation table) with only 4 partitions per hard drive followed by exFAT which still only held 16
NTFS added ADS to windows which allows data to be stealthily added to other data 
ADS can be used to create an invisible file that slowly fills up your hard drive without showing it on the GUI which eventually crashes the kernel
ADS works for antivirus and sequel servers
ADS must be viewed through the CLI since they dont show up in the GUI 
Create an ADS using for example echo "Elden Ring does deserve GOTY" > something.exe:truth.txt

to see ADS with powershell you have to get-item .\something.exe -stream * to check individual files followed by get-content .\calc.fuk -stream truth.txt to read it
you need a whole dang script to read through files in a directory to find ADS ex. 
get-childitem <path> | foreach-object { get-item $_.fullName -stream * } | where { $_.stream -ne $DATA } | get-content (to read it if ya need it) 

